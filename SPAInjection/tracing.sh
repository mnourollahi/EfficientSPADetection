#!/bin/bash
lttng-sessiond --daemonize
output_base_dir="/media/masoum/track2/track3/newProbInjec/blob-hometimeline-writeReadtimeline-noise-highload-25Nov"
# Outer loop
for i in {1..30}
do
    # Create outer folder
    outer_folder="$output_base_dir/folder_$i"
    mkdir -p "$outer_folder"
    
    # Inner loop
    for j in {1..10}
    do
        # Create inner folder inside the outer folder
        inner_folder="$outer_folder/subfolder_$j"
        mkdir -p "$inner_folder"
        
    	output_dir="$inner_folder"
    	
    	sleep 10
	lttng create  test-session --output="$output_dir"
	lttng enable-channel --kernel --tracefile-count=2048 --tracefile-size=2M --num-subbuf=4 --subbuf-size=10M kernel-channel
	lttng enable-channel --userspace --tracefile-count=2048 --tracefile-size=2M --num-subbuf=4 --subbuf-size=10M ust-channel
	lttng enable-event  --userspace 'jaeger*' --channel=ust-channel --session test-session
	lttng enable-event  -k --channel=kernel-channel --syscall recvfrom,recvmsg,recvmmsg,sendto,sendmsg,sendmmsg --filter='$ctx.pid_ns  == 4026532583  || $ctx.pid_ns ==    4026532584  || $ctx.pid_ns ==    4026532585  || $ctx.pid_ns ==    4026532586  || $ctx.pid_ns ==    4026532588  || $ctx.pid_ns ==    4026532667  || $ctx.pid_ns ==    4026532676  || $ctx.pid_ns ==    4026532680  || $ctx.pid_ns ==    4026532681  || $ctx.pid_ns ==    4026532682  || $ctx.pid_ns ==    4026532683  || $ctx.pid_ns ==    4026532685  || $ctx.pid_ns ==    4026532697  || $ctx.pid_ns ==    4026532698  || $ctx.pid_ns ==    4026532699  || $ctx.pid_ns ==    4026532707  || $ctx.pid_ns ==    4026532711  || $ctx.pid_ns ==    4026532829  || $ctx.pid_ns ==    4026532830  || $ctx.pid_ns ==    4026532831  || $ctx.pid_ns ==    4026532833  || $ctx.pid_ns ==    4026532911  || $ctx.pid_ns ==    4026532912  || $ctx.pid_ns ==    4026532913  || $ctx.pid_ns ==    4026532914  || $ctx.pid_ns ==    4026532916  || $ctx.pid_ns ==    4026532985  || $ctx.pid_ns ==    4026532986  || $ctx.pid_ns ==    4026532987  || $ctx.pid_ns ==    4026532989  || $ctx.pid_ns ==    4026533059  || $ctx.pid_ns ==    4026533060  || $ctx.pid_ns ==    4026533061  || $ctx.pid_ns ==    4026533063  || $ctx.pid_ns ==    4026533065  || $ctx.pid_ns ==    4026533135  || $ctx.pid_ns ==    4026533136  || $ctx.pid_ns ==    4026533137  || $ctx.pid_ns ==    4026533138  || $ctx.pid_ns ==    4026533140  || $ctx.pid_ns ==    4026533209  || $ctx.pid_ns ==    4026533210  || $ctx.pid_ns ==    4026533211  || $ctx.pid_ns ==    4026533212  || $ctx.pid_ns ==    4026533214  || $ctx.pid_ns ==    4026533283  || $ctx.pid_ns ==    4026533284  || $ctx.pid_ns ==    4026533291  || $ctx.pid_ns ==    4026533293  || $ctx.pid_ns ==    4026533294  || $ctx.pid_ns ==    4026533300  || $ctx.pid_ns ==    4026533301  || $ctx.pid_ns ==    4026533302  || $ctx.pid_ns ==    4026533303  || $ctx.pid_ns ==    4026533305  || $ctx.pid_ns ==    4026533358  || $ctx.pid_ns ==    4026533359  || $ctx.pid_ns ==    4026533360  || $ctx.pid_ns ==    4026533361  || $ctx.pid_ns ==    4026533363  || $ctx.pid_ns ==    4026533367  || $ctx.pid_ns ==    4026533368  || $ctx.pid_ns ==    4026533369  || $ctx.pid_ns ==    4026533370  || $ctx.pid_ns ==    4026533372  || $ctx.pid_ns ==    4026533445  || $ctx.pid_ns ==    4026533446  || $ctx.pid_ns ==    4026533447  || $ctx.pid_ns ==    4026533448  || $ctx.pid_ns ==    4026533450  || $ctx.pid_ns ==    4026533519  || $ctx.pid_ns ==    4026533520  || $ctx.pid_ns ==    4026533521  || $ctx.pid_ns ==    4026533522  || $ctx.pid_ns ==    4026533524  || $ctx.pid_ns ==    4026533593  || $ctx.pid_ns ==    4026533594  || $ctx.pid_ns ==    4026533595  || $ctx.pid_ns ==    4026533596  || $ctx.pid_ns ==    4026533598  || $ctx.pid_ns ==    4026533671  || $ctx.pid_ns ==    4026533672  || $ctx.pid_ns ==    4026533674  || $ctx.pid_ns ==    4026533743  || $ctx.pid_ns ==    4026533744  || $ctx.pid_ns ==    4026533745  || $ctx.pid_ns ==    4026533746  || $ctx.pid_ns ==    4026533748  || $ctx.pid_ns ==    4026533817  || $ctx.pid_ns ==    4026533818  || $ctx.pid_ns ==    4026533820  || $ctx.pid_ns ==    4026533889  || $ctx.pid_ns ==    4026533890  || $ctx.pid_ns ==    4026533891  || $ctx.pid_ns ==    4026533892  || $ctx.pid_ns ==    4026533894  || $ctx.pid_ns ==    4026533963  || $ctx.pid_ns ==    4026533964  || $ctx.pid_ns ==    4026533965  || $ctx.pid_ns ==    4026533966  || $ctx.pid_ns ==    4026533968  || $ctx.pid_ns ==    4026534125  || $ctx.pid_ns ==    4026534126  || $ctx.pid_ns ==    4026534127  || $ctx.pid_ns ==    4026534128  || $ctx.pid_ns ==    4026534130  || $ctx.pid_ns ==    4026534199  || $ctx.pid_ns ==    4026534200  || $ctx.pid_ns ==    4026534201  || $ctx.pid_ns ==    4026534203  || $ctx.pid_ns ==    4026534275  || $ctx.pid_ns ==    4026534276  || $ctx.pid_ns ==    4026534277  || $ctx.pid_ns ==    4026534278  || $ctx.pid_ns ==    4026534280  || $ctx.pid_ns ==    4026534353  || $ctx.pid_ns ==    4026534354  || $ctx.pid_ns ==    4026534355  || $ctx.pid_ns ==    4026534356  || $ctx.pid_ns ==    4026534358  || $ctx.pid_ns ==    4026534431  || $ctx.pid_ns ==    4026534432  || $ctx.pid_ns ==    4026534433  || $ctx.pid_ns ==    4026534434  || $ctx.pid_ns ==    4026534436  || $ctx.pid_ns ==    4026534507  || $ctx.pid_ns ==    4026534508  || $ctx.pid_ns ==    4026534509  || $ctx.pid_ns ==    4026534510  || $ctx.pid_ns ==    4026534512  || $ctx.pid_ns ==    4026534586  || $ctx.pid_ns ==    4026534587  || $ctx.pid_ns ==    4026534588  || $ctx.pid_ns ==    4026534589  || $ctx.pid_ns ==    4026534591  || $ctx.pid_ns ==    4026534660  || $ctx.pid_ns ==    4026534666  || $ctx.pid_ns ==    4026534667  || $ctx.pid_ns ==    4026534668  || $ctx.pid_ns ==    4026534795  || $ctx.pid_ns ==    4026534797  || $ctx.pid_ns ==    4026534868  || $ctx.pid_ns ==    4026534869  || $ctx.pid_ns ==    4026534870  || $ctx.pid_ns ==    4026534871  || $ctx.pid_ns ==    4026534873  || $ctx.pid_ns ==    4026534945  || $ctx.pid_ns ==    4026534946  || $ctx.pid_ns ==    4026534947  || $ctx.pid_ns ==    4026534948  || $ctx.pid_ns ==    4026534950  || $ctx.pid_ns ==    4026535023  || $ctx.pid_ns ==    4026535024  || $ctx.pid_ns ==    4026535025  || $ctx.pid_ns ==    4026535027  || $ctx.pid_ns ==    4026535095  || $ctx.pid_ns ==    4026535096  || $ctx.pid_ns ==    4026535097  || $ctx.pid_ns ==    4026535098  || $ctx.pid_ns ==    4026535100  || $ctx.pid_ns ==    4026535175  || $ctx.pid_ns ==    4026535176  || $ctx.pid_ns ==    4026535177  || $ctx.pid_ns ==    4026535178  || $ctx.pid_ns ==    4026535180  || $ctx.pid_ns ==    4026535250  || $ctx.pid_ns ==    4026535251  || $ctx.pid_ns ==    4026535252  || $ctx.pid_ns ==    4026535253  || $ctx.pid_ns ==    4026535254  || $ctx.pid_ns ==    4026535256  || $ctx.pid_ns ==    4026535328  || $ctx.pid_ns ==    4026535329  || $ctx.pid_ns ==    4026535330  || $ctx.pid_ns ==    4026535331  || $ctx.pid_ns ==    4026535333  || $ctx.pid_ns ==    4026535337  || $ctx.pid_ns ==    4026535338  || $ctx.pid_ns ==    4026535339  || $ctx.pid_ns ==    4026535340  || $ctx.pid_ns ==    4026535342  || $ctx.pid_ns ==    4026535488  || $ctx.pid_ns ==    4026535489  || $ctx.pid_ns ==    4026535490  || $ctx.pid_ns ==    4026535492  || $ctx.pid_ns ==    4026535562  || $ctx.pid_ns ==    4026535563  || $ctx.pid_ns ==    4026535564  || $ctx.pid_ns ==    4026535565  || $ctx.pid_ns ==    4026535567  || $ctx.pid_ns ==    4026535648  || $ctx.pid_ns ==    4026535649  || $ctx.pid_ns ==    4026535650  || $ctx.pid_ns ==    4026535651  || $ctx.pid_ns ==    4026535653 ' --session test-session
	lttng add-context -k -t tid -t vtid -t  pid -t vpid
	lttng add-context -u -t tid -t vtid -t  pid -t vpid
	lttng start  test-session 
	sleep 6
	lttng stop test-session 
	lttng destroy test-session 
	sleep 20
    done
done

